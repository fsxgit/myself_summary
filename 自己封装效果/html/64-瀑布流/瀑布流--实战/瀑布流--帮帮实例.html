<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title>项目图片</title>
    <link rel="stylesheet" href="css/base.css"/>
    <link rel="stylesheet" href="css/common.css"/>
    <link rel="stylesheet" href="css/css.css"/>
    <style>
        body,html{overflow: visible;}
        body, ul, li, h3 { margin: 0; padding: 0; list-style: none; font: bold 12px "微软雅黑"; }
        /*瀑布流布局样式*/
        #lxf-box { position: relative; }
        #lxf-box li { position: absolute; background: #fff; border: solid 1px #ccc; text-align: center; padding: 10px; left: 0px; top: 0; }
        h3 { padding-top: 8px; }
        #lxf-box li img { width: 300px; height: auto; display: block; border: 0 }

        .imgShodaw{width:100%; height:100%; background: rgba(0,0,0,0.7); position:fixed; left:0; top:0; display: none;}
        .imgBoxWai{width:800px; height:600px; padding:50px 100px;  margin-left:auto; margin-right:auto; background: #000; position: relative;}
        .imgBoxNei{width:800px; height:600px;  text-align: center;  display: table-cell;  vertical-align:middle; font-size: 0; overflow: hidden;}
        .imgBoxNei img{max-width:800px; height:auto; max-height:600px; display: inline-block;}

        .btnPrev{width: 100px; height:100%; cursor: pointer; position: absolute; left:0; top:0; background: url("images/prev.png") no-repeat center center; background-size:20px 40px;  z-index: 2;}
        .btnNext{width: 100px; height: 100%;  cursor: pointer; position: absolute; right:0; top:0; background: url("images/next.png") no-repeat center center; background-size:20px 40px; z-index: 2;}
        .lb-close{width: 40px; height: 40px;  cursor: pointer; position: absolute; right:0; top:0; z-index: 10;}
    </style>
</head>
<body>
<!--头部-->

<!--头部 end-->
<!--内容-->
<div class="index-box">
    <!--导航-->
    <div class="ind-top">
        <div class="main oh">
           <div class="fl ind-nav">
               <a href="index.html" class="active">首页</a>
               <a href="xiangmu.html">公益项目</a>
               <a href="huodong.html">公益活动</a>
               <a href="zixun.html">公益资讯</a>
               <a href="mingxing.html">明星公益</a>
           </div>
            <div class="ind-fb fr">
                发布项目/活动
            </div>
        </div>
    </div>
    <!--导航 end-->
   <!--title-->
    <div class="bk-nav-tit main">
        <p class="nav"><a href="javascript:;">首页</a>  》 <a href="javascript:;">公益项目</a> 》 项目图片</p>
    </div>
   <!--title end-->
    <!--公益项目-->
    <div class="ind-xm main">
            <ul id="lxf-box">
                <li><a href="javascript:;"><img src="images/img3.jpg"></a></li>
                <li><a href="javascript:;"><img src="images/img4.jpg"></a></li>
                <li><a href="javascript:;"><img src="images/img43.png"></a></li>
                <li><a href="javascript:;"><img src="images/img8.jpg"></a></li>
                <li><a href="javascript:;"><img src="images/img44.png"></a></li>
                <li><a href="javascript:;"><img src="images/img3.jpg"></a></li>
                <li><a href="javascript:;"><img src="images/img5.jpg"></a></li>
                <li><a href="javascript:;"><img src="images/img11.jpg"></a></li>
                <li><a href="javascript:;"><img src="images/img12.jpg"></a></li>
                <li><a href="javascript:;"><img src="images/img22.jpg"></a></li>
                <li><a href="javascript:;"><img src="images/img21.jpg"></a></li>
                <li><a href="javascript:;"><img src="images/img9.jpg"></a></li>
                <li><a href="javascript:;"><img src="images/img10.jpg"></a></li>
                <li><a href="javascript:;"><img src="images/img24.jpg"></a></li>
                <li><a href="javascript:;"><img src="images/img25.jpg"></a></li>
                <li><a href="javascript:;"><img src="images/img6.jpg"></a></li>
                <li><a href="javascript:;"><img src="images/img7.jpg"></a></li>
                <li><a href="javascript:;"><img src="images/img42.png"></a></li>
                <li><a href="javascript:;"><img src="images/img3.jpg"></a></li>
                <li><a href="javascript:;"><img src="images/img4.jpg"></a></li>
                <li><a href="javascript:;"><img src="images/img43.png"></a></li>
                <li><a href="javascript:;"><img src="images/img8.jpg"></a></li>
                <li><a href="javascript:;"><img src="images/img44.png"></a></li>
                <li><a href="javascript:;"><img src="images/img3.jpg"></a></li>
                <li><a href="javascript:;"><img src="images/img5.jpg"></a></li>
                <li><a href="javascript:;"><img src="images/img11.jpg"></a></li>
                <li><a href="javascript:;"><img src="images/img12.jpg"></a></li>
                <li><a href="javascript:;"><img src="images/img22.jpg"></a></li>
                <li><a href="javascript:;"><img src="images/img21.jpg"></a></li>
                <li><a href="javascript:;"><img src="images/img9.jpg"></a></li>
                <li><a href="javascript:;"><img src="images/img10.jpg"></a></li>
                <li><a href="javascript:;"><img src="images/img24.jpg"></a></li>
                <li><a href="javascript:;"><img src="images/img25.jpg"></a></li>
                <li><a href="javascript:;"><img src="images/img6.jpg"></a></li>
                <li><a href="javascript:;"><img src="images/img7.jpg"></a></li>
                <li><a href="javascript:;"><img src="images/img42.png"></a></li>
            </ul>

<!--图片预览-->
        <div class="imgShodaw">
            <div class="imgBoxWai">
                <div class="lb-close">
                    <img src="images/close1.png" alt=""/>
                </div>
                <div class="btnPrev"></div>
                <div class="btnNext"></div>
                <div class="imgBoxNei"><img src="images/1.jpg" alt=""/></div>
            </div>
        </div>
<!--图片预览 end-->
    </div>
    <!--公益项目 end-->
    <!--翻页-->
    <div class="c-pages fl tc">
        <span class="upPage">上一页</span>
        <a href="javascript:;" class="active">1</a>
        <a href="javascript:;">2</a>
        <a href="javascript:;">3</a>
        <a href="javascript:;">4</a>
        <a href="javascript:;" class="dotted">...</a>
        <a href="javascript:;">10</a>
        <span class="downPage">下一页</span>
    </div>
    <!--翻页 end-->
</div>
<!--内容 end-->


<!--底部-->

<!--底部 end-->
<script src="js/jquery.min.js"></script>
<script>
   $(function(){
       var margin = 10;//这里设置间距
       var li=$("li");//这里是区块名称
       var	li_W = li[0].offsetWidth+margin;//取区块的实际宽度（包含间距，这里使用源生的offsetWidth函数，不适用jQuery的width()函数是因为它不能取得实际宽度，例如元素内有pandding就不行了）
       function liuxiaofan(){//定义成函数便于调用
           var h=[];//记录区块高度的数组
           var n = 1000/li_W|0;//窗口的宽度除以区块宽度就是一行能放几个区块
           for(var i = 0;i < li.length;i++) {//有多少个li就循环多少次
               li_H = li[i].offsetHeight;//获取每个li的高度
               if(i < n) {//n是一行最多的li，所以小于n就是第一行了
                   h[i]=li_H;//把每个li放到数组里面
                   li.eq(i).css("top",0);//第一行的Li的top值为0
                   li.eq(i).css("left",i * li_W);//第i个li的左坐标就是i*li的宽度
               }
               else{
                   min_H =Math.min.apply(null,h) ;//取得数组中的最小值，区块中高度值最小的那个
                   minKey = getarraykey(h, min_H);//最小的值对应的指针
                   h[minKey] += li_H+margin ;//加上新高度后更新高度值
                   li.eq(i).css("top",min_H+margin);//先得到高度最小的Li，然后把接下来的li放到它的下面
                   li.eq(i).css("left",minKey * li_W);	//第i个li的左坐标就是i*li的宽度
               }
               $("h3").eq(i).text("编号："+i+"，高度："+li_H);//把区块的序号和它的高度值写入对应的区块H3标题里面
           }

//           使 最大的top+此图片的height = 父级的高度，解决position不占文档流的问题
           var max = parseInt($("li").eq(0).css("top"));
           var ind = 0;
           $("li").each(function(i){
               var a= parseInt($(this).css("top"));
               if(a > max){
                   max = a;
                   ind = i;
               }
           })
           console.log(max);
           console.log(ind);
           console.log($("li").eq(ind).outerHeight());
           var Hei = max+$("li").eq(ind).outerHeight();
           console.log(Hei);
           $("#lxf-box").height(Hei);


       }
       /* 使用for in运算返回数组中某一值的对应项数(比如算出最小的高度值是数组里面的第几个) */
       function getarraykey(s, v) {for(k in s) {if(s[k] == v) {return k;}}}
       /*这里一定要用onload，因为图片不加载完就不知道高度值*/
       window.onload = function() {liuxiaofan();};
       /*浏览器窗口改变时也运行函数*/
       window.onresize = function() {liuxiaofan();};
   })



//    图片预览
   imgLunbo();
   function imgLunbo(){
       var oShodaw = $(".imgShodaw");
       var oWai = $(".imgBoxWai");
       var oImg = $(".imgBoxNei img");
       var aImgs = $("#lxf-box li");
       var oPrev = $(".btnPrev");
       var oNext = $(".btnNext");
       var oClose = $(".lb-close")
       var oMT = ($(window).height()- oWai.outerHeight())/2;


       oWai.css("marginTop",oMT);
       var len = aImgs.length-1;
       var ii = 0;
       aImgs.on("click",function(){
           ii = $(this).index();
           var src = $(this).find("img").attr("src");
           oImg.attr("src",src);
           oShodaw.show();

       });



       oPrev.click(function(){
           if(ii == 0){
               alert("您好,这已经是第一张了！")
           }else{
               ii = ii-1;
           }

           var src;
           aImgs.each(function(){
               if($(this).index() == ii){
                   src = $(this).find("img").attr("src");
               }

           });
           oImg.attr("src",src);

       });
       oNext.click(function(){

           if(ii == len){
               alert("您好,这已经是最后一张了！")
           }else{
               ii += 1;
           }

           var src;
           aImgs.each(function(){
               if($(this).index() == ii){
                   src = $(this).find("img").attr("src");
               }

           });
           oImg.attr("src",src);
       });

       oClose.click(function(){
           oShodaw.hide();
       })

       oWai.hover(function(){
           oClose.show();
           oPrev.show();
           oNext.show();
       },function(){
           oClose.hide();
           oPrev.hide();
           oNext.hide();
       })
   }

</script>
</body>
</html>