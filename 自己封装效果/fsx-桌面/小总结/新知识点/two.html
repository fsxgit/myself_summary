<!doctype html>
<html lang="en">

	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, user-scalable=yes, initial-scale=1.0, maximum-scale=4.0, minimum-scale=1.0">
		<meta http-equiv="X-UA-Compatible" content="ie=edge">
		<title>数据统计</title>
		<link rel="stylesheet" href="css/base.css">
		<link rel="stylesheet" href="css/two.css">
	</head>

	<body>
		<div class="statisticsBox">
			<div class="statisticsCenter">
				<div class="statisticsMid">
					<div class="statisticsLeft">
						<div style="display: flex;align-items: center;">
							<img class="return" id="tabReturn" src="images/return.png" />
							<div class="total" style="flex: 1;"><img src="images/x.png" style="margin-right: 0.1rem;" /><span id="defen"></span> <img src="images/x.png" style="margin-left: 0.1rem;" /></div>
						</div>
						<div class="" style="display: flex;">
							<div id="">
								<div class="deifen">
									<div class="tit">xx局部门画像
										<div class="c_txt_ts">
											<img src="./images/ts.png" alt="">
											<div class="tsTxt tsTxt_bureau">
												<div class="center">
													<div class="icon_title">
														<img src="images/txton.png" /> 图表说明
													</div>
													<div class="text">
														X局八项重点工作得分雷达图
													</div>
													<div class="icon_titleA">
														<img src="images/txton.png" /> 计算方法
													</div>
													<div class="text">
														详细得分及得分规则请进入每个重点工作页面查看
													</div>
												</div>
											</div>
										</div>
									</div>
									<div class="chartsBox" style="margin:0 auto;">
										<div id="chart1_container" style="width: 2rem; height: 1.7rem;"></div>
									</div>
								</div>
								<div class="qushi">
									<div class="tit">
										委办局得分趋势
										<div class="c_txt_ts">
											<img src="./images/ts.png" alt="">
											<div class="tsTxt tsTxt_bureau">
												<div class="center">
													<div class="icon_title">
														<img src="images/txton.png" /> 图表说明
													</div>
													<div class="text">
														X局大数据发展水平评价近期得分趋势
													</div>
												</div>
											</div>
										</div>
									</div>
									<div class="chartsBox" style="width:100%; height:1.6rem; margin:0 auto;">
										<div id="chart_qushi" style="width: 100%; height: 100%;margin-top: 0px;"></div>
									</div>
								</div>
							</div>
							<div class="bmpm">
								<div class="tit">部门重点工作排名
									<div class="c_txt_ts">
										<img src="./images/ts.png" alt="">
										<div class="tsTxt tsTxt_a">
											<div class="center">
												<div class="icon_title">
													<img src="images/txton.png" /> 图表说明
												</div>
												<div class="text">
													X局各项重点工作与全市部门对比排名结果
												</div>
											</div>
										</div>
									</div>
								</div>
								<div class="bmpmList">
									<ul id="bmpmList"></ul>
								</div>
							</div>
						</div>
					</div>
					<div class="total_a"><img src="images/x.png" style="margin-right: 0.1rem;" />全市排名 第<i style="color: #E6943E;" id="paiming">  </i>名<img src="images/x.png" style="margin-left: 0.1rem;" /></div>
					<div class="statisticsRight">
						<div class="title">重点工作</div>
						<div class="rule">
							<span><img src="./images/dot1.png" alt="">风险 < 60分</span>
							<span><img src="./images/dot2.png" alt="">预警 60-80分</span>
							<span><img src="./images/dot3.png" alt="">健康 > 80分</span>
						</div>
						<ul class="zdgzList" id="zdgzList">
						</ul>
					</div>
				</div>
				<div class="statisticsBot">
					<div class="zhengwu">
						<div class="title">政务数据汇聚率</div>
						<div class="rule">
							<span><img src="./images/dot4.png" alt="">已汇聚数据类</span>
							<span><img src="./images/dot5.png" alt="">目录链数据项总数</span>
							<span><img style="top:-0.02rem;" src="./images/dot6.png" alt="">政务数据汇聚率</span>
							<div class="c_txt_ts">
								<img src="./images/ts.png" alt="">
								<div class="tsTxt">
									<div class="center">
										<div class="icon_title">
											<img src="images/txton.png" /> 图表说明
										</div>
										<div class="text">
											X局政务数据汇聚情况
										</div>
										<div class="icon_titleA">
											<img src="images/txton.png" /> 计算方法
										</div>
										<div class="text">
											汇聚率=（本委办局已完成汇聚的数据类数/本委办局应汇聚的数据类数）*100%
										</div>
									</div>
								</div>
							</div>
						</div>
						<div class="chartsBox" style="width:100%; height:1.2rem; margin:0 auto;">
							<div id="chart2_container" style="width: 100%; height: 100%;"></div>
						</div>
					</div>
					<div class="datalv">
						<div class="tit">
							<span>数据共享率</span><span>数据开放率</span>
							<div class="c_txt_ts" style="padding:0.12rem 0; margin-top: -0.02rem; margin-right:0.2rem;">
								<img src="./images/ts.png" alt="">
								<div class="tsTxt">
									<div class="center">
										<div class="icon_title">
											<img src="images/txton.png" /> 图表说明
										</div>
										<div class="text">
											X局大数据平台实际共享数据和开放数据的情况
										</div>
										<div class="icon_titleA">
											<img src="images/txton.png" /> 计算方法
										</div>
										<div class="text">
											共享率=（本委办局实际共享数据项数量/（本委办局有条件共享数据项数量+本委办局无条件共享数据项数量））*100%
											<br /> 开放率=（本委办局实际开放数据项数量/目录链内本委办局可开放数据项数）*100%
										</div>
									</div>
								</div>
							</div>
						</div>

						<div class="chartsBox" style="width:100%; height:1.8rem;display: flex;">
							<div id="chart3_container" style="width: 80%; height: 100%;"></div>
							<div id="chart4_container" style="width: 70%; height: 100%;margin-left: -0.9rem;"></div>
						</div>
					</div>
					<div class="zaixian">
						<div class="title">在线办理政务服务事项增长率</div>
						<div class="rule">
							<span><img src="./images/dot5.png" alt="">在线办理事项数</span>
							<span><img src="./images/dot7.png" alt="">在线办理事项增长率</span>
							<div class="c_txt_ts" style="padding:0.12rem 0; margin-top: -0.14rem; margin-right:0.2rem;">
								<img src="./images/ts.png" alt="">
								<div class="tsTxt zx_tsTxt">
									<div class="center">
										<div class="icon_title">
											<img src="images/txton.png" /> 图表说明
										</div>
										<div class="text">
											X局政务服务事项的在线办理事项数的增长情况
										</div>
										<div class="icon_titleA">
											<img src="images/txton.png" /> 计算方法
										</div>
										<div class="text">
											增长率=（（本统计周期内本委办局在线办理政务服务事项数-上一周期本委办局在线办理政务服务事项数／上一周期在线办理政务服务事项数））*100%
										</div>
									</div>
								</div>
							</div>
						</div>
						<div class="chartsBox" style="width:100%; height:1.2rem; ">
							<div id="chart5_container" style="width: 100%; height: 100%;"></div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<script src="common/rem.js" type="text/javascript" charset="utf-8"></script>
		<script src="common/jquery.min.js"></script>
		<script src="common/echarts.min.js"></script>
		
		<script>
			var search = window.location.search;
			var id = getSearchString('id', search); 
			function getSearchString(key, Url) {
			    var str = Url;
			    str = str.substring(1, str.length); // 获取URL中?之后的字符（去掉第一位的问号）
			    var arr = str.split("&");
			    var obj = new Object();
			    for (var i = 0; i < arr.length; i++) {
			        var tmp_arr = arr[i].split("=");
			        obj[decodeURIComponent(tmp_arr[0])] = decodeURIComponent(tmp_arr[1]);
			    }
			    return obj[key];
			}
			let obj = [
				{
					title:'数据汇聚',
					min:1,
					max:2,
					son:'',
					titleTxt:"反映本委办局已经汇聚的政务数据、社会数据的成效",
					box:[],
					dot:"",
					url:"bureau/dataAggregation.html?id=4",
					Atype:"18"
				},
				{
					title:'数据共享',
					min:3,
					max:5,
					son:'',
					titleTxt:"反映本委办局政务数据是否可以共享、共享方式、共享规模、共享结果",
					box:[],
					dot:"",
					url:"bureau/three.html?id=4",
					Atype:"19"
				},
				{
					title:'数据开放',
					min:6,
					max:8,
					son:'',
					titleTxt:"反映本委办局政务数据是否可以开放、开放规模、参与开放情况、开放成效",
					box:[],
					dot:"",
					url:"bureau/dataOpening.html?id=4",
					Atype:"20"
				},
				{
					title:'平台服务',
					max:10,
					min:9,
					son:'',
					titleTxt:"反映本委办局使用市大数据平台资源所支撑的应用开发情况",
					box:[],
					dot:"",
					url:"bureau/platformService.html?id=4",
					Atype:"21"
				},
				{
					title:'数据治理',
					min:11,
					max:11,
					son:'',
					titleTxt:"反映本委办局已汇聚数据质量情况",
					box:[],
					dot:"",
					url:"",
					Atype:"22"
				},
				{
					title:'数据应用',
					min:12,
					max:13,
					son:'',
					titleTxt:"反映数据支撑应用的能力，包括政务服务事项办理、政务服务平台支持、领导驾驶舱、统一身份认证等",
					box:[],
					dot:"",
					url:"bureau/dataApplication.html?id=4",
					Atype:"23"
				},
				{
					title:'目录上链',
					min:14,
					max:15,
					son:'',
					titleTxt:"反映目录链中职责目录、系统目录、数据目录的对应情况和系统交钥匙情况",
					box:[],
					dot:"",
					url:"bureau/catalogChain.html?id=4",
					Atype:"24"
				},
				{
					title:'系统入云',
					min:16,
					max:17,
					son:'',
					titleTxt:"反映本委办局使用市政务云的效果",
					box:[],
					dot:"",
					url:"bureau/systemCloud.html?id=4",
					Atype:"25"
				},
			]
			getRanking()
			function getRanking(){
				$.ajax({
					type: "get",
					url: "http://47.56.170.82:8080/api/dataapply/getSingleBigdataDevelopRank?departmentId="+id,
					dataType: "json",
					headers: {
						"content-type": "application/json;charset=utf-8"
					},
					success: function(res) {
						console.log(res.data.ranking)
						let defenHtml=`${res.data.departmentName}<i>${res.data.score}</i>`
						$('#defen').html(defenHtml)
						$('#paiming').html(` ${res.data.ranking} `)
						
					}
				})
			}
			//得分趋势
			chart1();
			function chart1() {
				$.ajax({
					type: "get",
					url: "http://47.56.170.82:8080/api/dataapply/getScore?departmentId="+id+"&type=1",
					dataType: "json",
					headers: {
						"content-type": "application/json;charset=utf-8"
					},
					success: function(res) {
						// 数据处理
						var xData = [];
						var yData = [];
						$.each(res.data, function(i, v) {
							xData.push(v.dataPeriod);
							yData.push(v.score);
						});
						// 数据处理 end
						var dom = document.getElementById("chart_qushi");
						var myChart = echarts.init(dom);
						var option = {
							tooltip: {
								trigger: 'item',
								formatter: "{b} : {c}"
							},
							legend:{
								left:20
							},
							xAxis: {
								type: 'category',
								name: '',
								boundaryGap: true,
								data: xData,
								splitLine: {
									show: false
								},
								axisTick: { // y轴刻度
									show: true
								},
								/*改变x轴颜色*/
								axisLine: {
									lineStyle: {
										color: '#39508c'
									}
								},
								//  改变x轴字体颜色和大小
								axisLabel: {
									textStyle: {
										color: 'rgba(255,255,255,0.5)'
									}
								}
							},
							yAxis: {
								type: 'value',
								name: '分',
								axisTick: {
									inside: true
								},
								scale: true,
								max: 100,
								minInterval: 10,
								axisLabel: {
									margin: 0,
									formatter: function(value, index) {
										if(value >= 10000 && value < 10000000) {
											value = value / 10000 + "万";
										} else if(value >= 10000000) {
											value = value / 10000000 + "千万";
										}
										return value;
									},
									textStyle: {
										color: 'rgba(255,255,255,0.5)'
									}
								},
								splitLine: {
									show: true,
									lineStyle: {
										color: '#39508c'
									}
								},
								/*改变y轴颜色*/
								axisLine: {
									lineStyle: {
										color: '#39508c'
									}
								}
							},
							grid: {
								left: 30,
								right: 21,
								top: 30,
								bottom: 30
							},
							series: [{
								data: yData,
								type: 'line',
								itemStyle: {
									normal: {
										color: '#2fb795',
										lineStyle: {
											normal: {
												color: '#2fb795'
											}
										},
										label: {
											show: true,
											color: '#fff',
										},
										lineStyle: {
											width: 1.5 // 0.1的线条是非常细的了
										}
									}
								},
								areaStyle: {
									normal: {
										barBorderRadius: 30,
										color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [{
											offset: 1,
											color: 'rgba(13,246,238,0.1)'
										}, {
											offset: 0,
											color: 'rgba(13,246,238,1)'
										}]),
									}
								}
							}],
							axisLabel: {
								color: "#000",
								interval: 0,
								formatter: function(value) {
									if(value.length > 12) {
										return value.substring(0, 12) + "...";
									} else {
										return value;
									}
								}
							}
						};
						if(option && typeof option === "object") {
							myChart.setOption(option, true);
						}
					}
				})
			}
			//    政务数据汇聚率
			chart2();
			function chart2() {
				$.ajax({
	                type: "get",
	                url: "http://47.56.170.82:8080/api/rate/getConvergeRate?departmentId="+id,
	                dataType: "json",
	                headers:{"content-type": "application/json;charset=utf-8"},
	                success: function(res){
	                	var alreadyConvergeData = [];
						var shouldConvergeData = [];
						var time=[]
						var proportion=[]
						$.each(res.data, function(i, v) {
							alreadyConvergeData.push(v.alreadyConvergeData);
							shouldConvergeData.push(v.shouldConvergeData);
							proportion.push((v.alreadyConvergeData/v.shouldConvergeData).toFixed(2)*100)
							time.push(v.updatetime.substring(0,10))
						});
						var dom = document.getElementById("chart2_container");
						var myChart = echarts.init(dom);
						var option = {
							color: ['#e59a35', '#00e3f9'],
							tooltip: {
								trigger: 'axis',
								axisPointer: {
									type: 'shadow'
								},
								formatter: '{b0}<br/>{a0}: {c0}<br />{a1}: {c1}<br />{a2}: {c2}%<br />'
							},
							xAxis: [{
								type: 'category',
								data: time,
								axisTick: { // y轴刻度
									show: true
								},
								/*改变x轴颜色*/
								axisLine: {
									lineStyle: {
										color: '#39508c'
									}
								},
								//  改变x轴字体颜色和大小
								axisLabel: {
									textStyle: {
										color: 'rgba(255,255,255,0.5)'
									}
								}
							}],
							yAxis: [{
									name: '类',
									nameLocation: 'end',
									type: 'value',
									scale: true,
									minInterval: 10,
									min: 0,
									splitLine: {
										show: true,
										lineStyle: {
											color: '#39508c'
										}
									},
									/*改变y轴颜色*/
									axisLine: {
										lineStyle: {
											color: 'rgba(255,255,255,0.5)'
										}
									}
								},
								{
									type: 'value',
									scale: true,
									splitLine: {
										show: false,
									},
									max: 100,
									min: 0,
									axisLine: {
										lineStyle: {
											color: 'rgba(255,255,255,0.5)'
										}
									},
									axisLabel: {
										formatter: '{value}%', //右侧以百分比进行展示
										show: true,
										textStyle: {
											color: 'rgba(255,255,255,0.5)',
											fontSize: '12'
										}
									}
								}
							],
							grid: {
								left: 60,
								right: 60,
								top: 30,
								bottom: 20
							},
							series: [{
									name: '已汇聚数据类',
									type: 'bar',
									barGap: 0,
									data: alreadyConvergeData,
									barWidth: 8, //柱图宽度
									itemStyle: {
										normal: {
											barBorderRadius: 30,
											color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [{
												offset: 0,
												color: '#ce8544'
											}, {
												offset: 1,
												color: '#e79f30'
											}]),
										}
									}
								},
								{
									name: '目录链数据项总数',
									type: 'bar',
									data: shouldConvergeData,
									barWidth: 8, //柱图宽度
									itemStyle: {
										normal: {
											barBorderRadius: 30,
											color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [{
												offset: 0,
												color: '#0092f9'
											}, {
												offset: 1,
												color: '#00e8f9'
											}]),
										}
									}
								},
								{
									name: '政务数据汇聚率',
									yAxisIndex: 1,
									type: "line",
									data: proportion,
									itemStyle: {
										normal: {
											color: '#2fb795',
											lineStyle: {
												normal: {
													color: '#2fb795'
												}
											},
											label: {
												show: false,
												color: '#fff',
											},
											lineStyle: {
												width: 1 // 0.1的线条是非常细的了
											}
										}
									}
								}
							]
						};
						if(option && typeof option === "object") {
							myChart.setOption(option, true);
						}
	                }
	           })    
			}
			var compare = function (obj1, obj2) {
			    var val1 = obj1.Ascore;
			    var val2 = obj2.Ascore;
			    if (val1 > val2) {
			        return -1;
			    } else if (val1 < val2) {
			        return 1;
			    } else {
			        return 0;
			    }            
			} 
			//重点工作
			let chartLd=[]
			getData()
			function getData(){
				$.ajax({
	                type: "get",
	                url: "http://47.56.170.82:8080/api/dataapply/getDataApply?departmentId="+id,
	                dataType: "json",
	                headers:{"content-type": "application/json;charset=utf-8"},
	                success: function(res){
	                	let Data = res.data;
	                	let dataLIst = '';
	                	for(let x in obj){
	                		for(let y in Data){
	                			 if(Data[y].score < 60){
	                			 	Data[y].src = "./images/lamp_r.png"
	                			 } else if(Data[y].score > 80){
                			 		Data[y].src = "./images/lamp_g.png"
	                			 }else{
                			 		Data[y].src = "./images/lamp_y.png"
	                			 }
								let NameList=["",
									{name:"政务数据汇聚",type:'1',tit:"包括已汇聚的政务数据情况、已汇聚政务数据更新情况"},
									{name:"共享准备情况",type:'3',tit:"包括本委办局目前可以共享的政务数据情况"},
									{name:"共享实施情况",type:'4',tit:"包括接口调用情况、前置共享交换数据量、已共享数据情况"},
									{name:"共享使用效果",type:'5',tit:"包括共享数据点赞情况、本委办局使用社会统采数据情况"},
									{name:"开放准备情况",type:'6',tit:"包括本委办局目前可以开放的政务数据情况、参与开放情况"},
									{name:"开放实施情况",type:'7',tit:"包括本委办局目前开放的政务数据量"},
									{name:"开放使用效果",type:'8',tit:"包括开放数据各种方式调用情况、本委办局对数据申请的答复情况"},
									{name:"平台使用情况",type:'10',tit:"包括本委办局是否成为租户情况、API接口和公用组件支撑应用开发情况"},
									{name:"数据质量",type:'11',tit:"包括本委办局已汇聚数据是否具有规范性、完整性、准确性、一致性、可用性"},
									{name:"总体情况",type:'12',tit:"包括政务服务平台接入情况、政务服务事项办理情况"},
									{name:"重点应用",type:'13',tit:"包括统一身份认证服务情况、电子证照情况、系统入领导驾驶舱情况"},
									{name:"目录链运行情况",type:'14',tit:"包括本委办局交钥匙系统情况"},
									{name:"目录完整性",type:'15',tit:"包括目录链中职责目录、系统目录、数据目录的对应情况"},
									{name:"政务云平台使用情况",type:'17',tit:"包括本委办局信息系统入云情况、入云系统资源使用情况"},
								]

//								Data[y].name=NameList[Data[y].type]
//								Data[y].tit=TitList[Data[y].type]
								for(let i in NameList){
									if(NameList[i].type==Data[y].type){
										Data[y].name=NameList[i].name
										Data[y].tit=NameList[i].tit
									}
								}

								if(Data[y].type==obj[x].Atype){
									obj[x].Ascore=Data[y].score
								}
								
	                			 if(Data[y].type <= obj[x].max  && Data[y].type >= obj[x].min ){
	                			 	obj[x].box.push(Data[y].score)
	                			 	obj[x].son += `<div class="item">
	                			 						<div class="img positioning" onmouseover='overShow(this)' onmouseout='outHide(this)'>
	                			 							<img src="${Data[y].src}" alt="">
	                			 							<div class="bounced">
	                			 								<p>${Data[y].score}</p>
	                			 								计算方式
	                			 							</div>
	                			 						</div>
	                			 						<div class="positioning zIndex" onmouseover='overShow(this)' onmouseout='outHide(this)'>
															<div class="name">
																<span>${Data[y].name}</span>
															</div>
															<div class="bounced">
																<span>${Data[y].tit}</span>
															</div>
														</div>
	                			 				</div>`;
	                			 }
	                		}
	                	}
	                	for (let item in obj) {
	                		if(obj[item].Ascore<60){
                				obj[item].dot="./images/dot1.png"
                			}else if(obj[item].Ascore>=60&&obj[item].Ascore<=80){
                				obj[item].dot="./images/dot2.png"
                			}else{
                				obj[item].dot="./images/dot3.png"
                			}
	                		dataLIst += `<li>
								<div class="tit positioning" onclick="tabJump('${obj[item].url}')" onmouseover='overShow(this)' onmouseout='outHide(this)'>
									<img src="${obj[item].dot}" alt="">${obj[item].title}
									<div class="bounced">
										<p>${obj[item].Ascore}分</p>
										${obj[item].titleTxt}
									</div>
								</div>
								<div class="items">
									${obj[item].son}
								</div>
							</li>`
	                	}	                	
	                	$('#zdgzList').html(dataLIst)
	                	let chart = document.getElementById("chart1_container");
						let myChart = echarts.init(chart);
						let option = {
							tooltip: {
								trigger: 'axis',
								position: 'right'
							},
							radar: [{
									splitNumber: 4,
									indicator: [{
											text: '数据汇聚',
											max: 100
										},
										{
											text: '数据共享',
											max: 100
										},
										{
											text: '数据开放',
											max: 100
										},
										{
											text: '平台服务',
											max: 100
										},
										{
											text: '数据治理',
											max: 100
										},
										{
											text: '数据应用',
											max: 100
										},
										{
											text: '目录上链',
											max: 100
										},
										{
											text: '系统入云',
											max: 100
										}
									],
									radius: 40,
									center: ['50%', '55%'],
									nameGap: 7,
									splitArea: {
										show: true,
										areaStyle: {
											color: ['none'] // 图表背景网格的颜色
										}
									},
									splitLine: {
										show: true,
										lineStyle: {
											width: 1,
											color: '#324B6F' // 图表背景网格线的颜色
										}
									},
									axisLine: {
										// 坐标轴线
										show: false // 默认显示，属性show控制显示与否
									},
								}
							],
							series: [{
								name: "部门画像",
								type: 'radar',
								symbolSize: 4, // 拐点的大小
								itemStyle: {
									normal: {
										color: "rgba(13,253,242,0)", // 图表中各个图区域的边框线拐点颜色
										lineStyle: {
											color: "#0DFDF2" // 图表中各个图区域的边框线颜色
										},
										areaStyle: {
											type: 'default'
										},
									}
								},
								tooltip: {
									trigger: 'item'
								},
								areaStyle: {
									normal: {
										color: 'rgba(36,157,159,.4)',
										width: 1,
										shadowColor: "rgba(36,157,159,.4)",
										shadowBlur: 5,
										shadowOffsetX: 0,
										shadowOffsetY: 0
									}
								},
								lineStyle: {
									normal: {
										color: '#0CFCF1',
										width: 1
									}
								}, //折线样式
								data: [{
									value: chartLd,
								}]
							}, ]
		
						};
						if(option && typeof option === "object") {
							myChart.setOption(option, true);
						}
	                }
                });
			}
			//部门重点工作排名
			getZdpm()
			function getZdpm(){
				$.ajax({
	                type: "get",
	                url: "http://47.56.170.82:8080/api/rate/getDataapplyKeyworkRank?departmentId="+id,
	                dataType: "json",
	                headers:{"content-type": "application/json;charset=utf-8"},
	                success: function(res){
	                	let zdpm=res.data
		            	let bmpmHtml=''
		            	for(let i in zdpm){
		            		if(zdpm[i].type==18){
		            			zdpm[i].title='数据汇聚'
		            		}else if(zdpm[i].type==19){
		            			zdpm[i].title='数据共享'
		            		}else if(zdpm[i].type==20){
		            			zdpm[i].title='数据开放'
		            		}else if(zdpm[i].type==21){
		            			zdpm[i].title='平台服务'
		            		}else if(zdpm[i].type==22){
		            			zdpm[i].title='数据治理'
		            		}else if(zdpm[i].type==23){
		            			zdpm[i].title='数据应用'
		            		}else if(zdpm[i].type==24){
		            			zdpm[i].title='目录上链'
		            		}else if(zdpm[i].type==25){
		            			zdpm[i].title='系统入云'
		            		}
		            		if(zdpm[i].scoreTrend<0){
		            			zdpm[i].zdpmSrc='./images/down.png'
		            			zdpm[i].srcTit="较上个月下降"
		            		}else{
		            			zdpm[i].zdpmSrc='./images/up.png'
		            			zdpm[i].srcTit="较上个月上升"
		            		}
		            		bmpmHtml+=`
		        				<li>
									<div class="name" >${zdpm[i].title}</div>
									<div class="rank">${zdpm[i].ranking}</div>
									<div class="status positioning" onmouseover='overShow(this)' onmouseout='outHide(this)'>
										<img src="${zdpm[i].zdpmSrc}" alt=""> ${Math.abs(zdpm[i].scoreTrend)}
										<div class="bounced bounced_bmpm">
											${zdpm[i].srcTit}
											${Math.abs(zdpm[i].scoreTrend)}
										</div>
									</div>
								</li>
		            		`
		            	}
		            	$('#bmpmList').html(bmpmHtml)
					}
	          	})
				
			}
			//    数据共享率
			chart3();
			function chart3() {
				$.ajax({
	                type: "get",
	                url: "http://47.56.170.82:8080/api/rate/getDatashareRate?departmentId="+id,
	                dataType: "json",
	                headers:{"content-type": "application/json;charset=utf-8"},
	                success: function(res){
						var echartData = [{
								value: 600,
								name: '实际共享'
							},
							{
								value: 400,
								name: '未实际共享'
							}
						];
						echartData[0].value=res.data[0].shareData
						echartData[1].value=res.data[0].canShareData+res.data[0].noShareData-res.data[0].shareData
						//    数据处理 end
						var dom = document.getElementById("chart3_container");
						var myChart = echarts.init(dom);
						var option = {
							tooltip: {
								show: true,
								trigger: 'item',
								formatter: "{b}数据 : {c} 项"
							},
							color: ['#ffc53a', '#0196ff'],
							stillShowZeroSum: false,
							series: [{
								startAngle: 180,
								clockwise: false,
		//						name: '数据共享率',
								type: 'pie',
								radius: '50%',
								center: ['47%', '50%'],
								avoidLabelOverlap: true,
								labelLine: {
									normal: {
										length: 7,
										length2: 14,
									},
								},
								label: {
									normal: {
										formatter:"{b} \n {d}%",
									}
								},
								data: echartData,
								itemStyle: {
									emphasis: {
										shadowBlur: 10,
										shadowOffsetX: 0,
										shadowColor: 'rgba(128, 128, 128, 0.5)'
									}
								}
							}]
						};
		
						if(option && typeof option === "object") {
							myChart.setOption(option, true);
						}
					}
	          })
				
			}

			//    数据开放率
			chart4();
			function chart4() {
				$.ajax({
	                type: "get",
	                url: "http://47.56.170.82:8080/api/rate/getDataopenRate?departmentId="+id,
	                dataType: "json",
	                headers:{"content-type": "application/json;charset=utf-8"},
	                success: function(res){
						let echartData = [{
								value: 21,
								name: '已开放'
							},
							{
								value: 79,
								name: '未开放'
							}
						];
						echartData[0].value=res.data[0].openData
						echartData[1].value=res.data[0].canOpenData-res.data[0].openData
						// 数据处理 end
						var dom = document.getElementById("chart4_container");
						var myChart = echarts.init(dom);
						var option = {
							tooltip: {
								trigger: 'item',
								formatter: "{b}数据 : {c}项"
							},
							color: ['#048bff', '#0ce9e0'],
							stillShowZeroSum: false,
							series: [{
								startAngle: 180,
								clockwise: false,
		//						name: '数据开放率',
								type: 'pie',
								radius: ['18%', '45%'],
								center: ['53%', '50%'],
								avoidLabelOverlap: true,
								roseType: 'radius',
								labelLine: {
									normal: {
										length: 4,
										length2: 8,
									}
								},
								label: {
									normal: {
										formatter:"{b} \n {d}%",
									}
								},
								data: echartData,
								itemStyle: {
									emphasis: {
										shadowBlur: 10,
										shadowOffsetX: 0,
										shadowColor: 'rgba(128, 128, 128, 0.5)'
									}
								}
							}]
						}
						if(option && typeof option === "object") {
							myChart.setOption(option, true);
						}
					}
	          	})
			}
			
			// 在线办理政务服务事项增长率
			chart5();
			function chart5() {
				$.ajax({
	                type: "get",
	                url: "http://47.56.170.82:8080/api/rate/getOnlineServiceRate?departmentId="+id,
	                dataType: "json",
	                headers:{"content-type": "application/json;charset=utf-8"},
	                success: function(res){
						var onLineData = [];
						var time=[]
						var proportion=[]
						$.each(res.data, function(i, v) {
							let a=0;
							let arr =res.data;
							arr.forEach((item,index) => {
								a= index < 2 ? 0 : a
								item.proportion=parseInt((item.onLineData-arr[a].onLineData)/arr[a].onLineData.toFixed(2) *100)
								a++
							})
							res.data[0].proportion = '-'
							onLineData.push(v.onLineData)
							proportion.push(v.proportion)
							time.push(v.dataPeriod)
							var dom = document.getElementById("chart5_container");
							var myChart = echarts.init(dom);
							var option = {
								color: ['#e59a35', '#00e3f9'],
								tooltip: {
									trigger: 'axis',
									axisPointer: {
										type: 'shadow'
									},
									formatter: '{b0}<br/>{a0}: {c0}<br />{a1}: {c1}%<br />'
								},
								xAxis: [{
									type: 'category',
									data: time,
									axisTick: { // y轴刻度
										show: true
									},
									/*改变x轴颜色*/
									axisLine: {
										lineStyle: {
											color: 'rgba(255,255,255,0)'
										},
									},
									//  改变x轴字体颜色和大小
									axisLabel: {
										interval:0,
										textStyle: {
											color: 'rgba(255,255,255,0.5)'
										}
									}
								}],
								yAxis: [{
										name: '项',
										nameLocation: 'end',
										type: 'value',
//										min: 0,
//										max: 500, //设置左侧最大值
										splitLine: {
											show: true,
											lineStyle: {
												color: '#39508c'
											}
										},
										/*改变y轴颜色*/
										axisLine: {
											lineStyle: {
												color: 'rgba(255,255,255,0.5)'
											}
										}
									},
									{
										type: 'value',
										scale: true,
										splitLine: {
											show: false
										},
//										max: 100,
										axisLine: {
											lineStyle: {
												color: '#39508c',
											}
										},
										axisLabel: {
											formatter: '{value}%', //右侧以百分比进行展示
											show: true,
											textStyle: {
												color: 'rgba(255,255,255,0.5)',
												fontSize: '12'
											}
										},
										textStyle: {
											color: 'rgba(255,255,255,0.5)',
											fontSize: '14'
										}
									}
								],
								grid: {
									left: 60,
									right: 60,
									top: 30,
									bottom: 30
								},
								series: [{ // For shadow
										name: '任务量',
										type: 'bar',
										itemStyle: {
											barBorderRadius: 30,
											color: 'rgba(255,255,255,0.1)'
										},
										barGap: '-100%',
										barCategoryGap: '40%',
//										data: [500, 500, 500, 500, 500],
										barWidth: 12, //柱图宽度
										animation: false
									},
									{
										name: '在线办理事项数',
										type: 'bar',
										itemStyle: {
											barBorderRadius: 30,
											color: new echarts.graphic.LinearGradient(
												0, 0, 0, 1, [{
														offset: 0,
														color: '#83bff6'
													},
													{
														offset: 0.5,
														color: '#188df0'
													},
													{
														offset: 1,
														color: '#188df0'
													}
												]
											)
										},
										emphasis: {
											itemStyle: {
												color: new echarts.graphic.LinearGradient(
													0, 0, 0, 1, [{
															offset: 0,
															color: '#2378f7'
														},
														{
															offset: 0.7,
															color: '#2378f7'
														},
														{
															offset: 1,
															color: '#83bff6'
														}
													]
												)
											}
										},
										data: onLineData,
										barWidth: 12, //柱图宽度
									},
									{
										name: '在线办理事项增长率',
										type: 'line',
										yAxisIndex: 1,
										data: proportion,
										itemStyle: {
											normal: {
												color: '#ff0000',
												lineStyle: {
													normal: {
														color: '#ff0000'
													}
												},
												label: {
													show: false,
													color: '#fff',
												},
												lineStyle: {
													width: 1 // 0.1的线条是非常细的了
												}
											}
										}
									}
								]
							};
							if(option && typeof option === "object") {
								myChart.setOption(option, true);
							}
						});
					}
	          	})
				
			}
			
			$(".c_txt_ts").mouseover(function() {
				$(this).find(".tsTxt").toggle();
			});
			$(".c_txt_ts").mouseout(function() {
				$(".tsTxt").hide();
			})
			function overShow(e) {
				var p = $(e).children('.bounced');
				p.attr("style", "display:block;");

			}
			function outHide(e) {
				var p = $(e).children('.bounced');
				p.attr("style", "display:none;");
			}
			$('#tabReturn').click(function(){
				window.history.go(-1);//返回上一页
			})
			function tabJump(e){
				window.location.href=e
			}
		</script>
	</body>

</html>